$(function(){jQuery.validator.addMethod("byteRange",function(c,b,d){var a=c.replace(/[^\x00-\xff]/gi,"--").length;if(a>d[1]||a<d[0]){return false}return true},"3-6位字母、下划线、数字、中文");jQuery.validator.addMethod("loginNameValidate",function(c,a,d){if(d==true){var b=/^[a-zA-Z_][a-zA-Z_0-9]*$/;if(b.test(c)){return true}return false}return true},"用户名以英文开头,不支持符号");jQuery.validator.addMethod("nickNameValidate",function(c,a,d){if(d==true){var b=/^[a-zA-Z_\u4e00-\u9fa5][a-zA-Z_0-9\u4e00-\u9fa5]*$/;if(b.test(c)){return true}return false}return true},"3-6位字母、下划线、数字、中文");$("#rdname").click(function(){$.post("/user/getRandomName","csrf_token="+token,function(b){var a=$.parseJSON(b);if(a.error!=0){alert("获取昵称失败!");return}$("#nickname").val(a.data.name);$("#nickname").trigger("blur")})});$("#signForm").validate({rules:{login_name:{required:true,rangelength:[4,16],loginNameValidate:true,remote:{url:"/user/checkLoginName",type:"post",dataType:"json",data:{login_name:function(){return $("#rlogin_name").val()},csrf_token:token}}},nickname:{required:true,byteRange:[3,12],nickNameValidate:true,remote:{url:"/user/checkNickName",type:"post",dataType:"json",data:{nickname:function(){return $("#nickname").val()},csrf_token:token}}},password:{required:true,rangelength:[6,16]},re_password:{required:true,rangelength:[6,16],equalTo:"#password"},agree:{required:true}},messages:{login_name:{required:"4-16位字母、下划线或数字",rangelength:"4-16位字母、下划线或数字",remote:"用户名已存在或包含敏感词"},nickname:{required:"3-6位字母、下划线、数字、中文",rangelength:"3-6位字母、下划线、数字、中文",remote:"昵称已存在或包含敏感词"},password:{required:"6-16位字母、数字",rangelength:"6-16位字母、数字"},re_password:{required:"6-16位字母、数字",rangelength:"6-16位字母、数字",equalTo:"两次输入的密码不一样"},agree:{required:"请勾选用户服务协议"}},errorPlacement:function(a,b){$(a).appendTo($(b).parent().parent())},success:function(a){$(a).html('<img src="../images/icons/icon_accept.png" />')},submitHandler:function(a){$("#hid_password").val(md5($("#password").val()));$("#password").val("abcdefg");$("#re_password").val("abcdefg");$("#submitBtn").attr("disabled",true);a.submit()}})});