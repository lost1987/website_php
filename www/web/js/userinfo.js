$(function(){$("#changePwdForm").validate({rules:{oldPass:{required:true,rangelength:[6,16]},newPass:{required:true,rangelength:[6,16]},newPass1:{required:true,rangelength:[6,16],equalTo:"#newPass"}},messages:{oldPass:{required:"6-16位字母、数字",rangelength:"6-16位字母、数字"},newPass:{required:"6-16位字母、数字",rangelength:"6-16位字母、数字"},newPass1:{required:"6-16位字母、数字",rangelength:"6-16位字母、数字",equalTo:"两次输入的密码不一致"}},debug:true,success:function(a){$(a).html('<img src="../images/icons/icon_accept.png" />')},errorPlacement:function(a,b){$(a).css("line-height","5.4rem").css("margin-left","5px");$(a).appendTo($(b).parent().parent())},submitHandler:function(a){old_pass=$("#oldPass").val();new_pass=$("#newPass").val();$.post("/userinfo/updatePassword","old_pass="+md5(old_pass)+"&new_pass="+md5(new_pass)+"&csrf_token="+token,function(b){var b=$.parseJson(b);if(b!=undefined){$("#oldPass").val("");$("#newPass").val("");$("#newPass1").val("");$("#changePwdModal").modal("hide");$.alert("修改成功!")}})}});$("#changePayPwdForm").validate({rules:{oldPayPass:{required:true,rangelength:[6,16]},newPayPass:{required:true,rangelength:[6,16]},newPayPass1:{required:true,rangelength:[6,16],equalTo:"#newPayPass"}},messages:{oldPayPass:{required:"6-16位字母、数字",rangelength:"6-16位字母、数字"},newPayPass:{required:"6-16位字母、数字",rangelength:"6-16位字母、数字"},newPayPass1:{required:"6-16位字母、数字",rangelength:"6-16位字母、数字",equalTo:"两次输入的密码不一致"}},debug:true,success:function(a){$(a).html('<img src="../images/icons/icon_accept.png" />')},errorPlacement:function(a,b){$(a).css("line-height","5.4rem").css("margin-left","5px");$(a).appendTo($(b).parent().parent())},submitHandler:function(a){old_pass=$("#oldPayPass").val();new_pass=$("#newPayPass").val();$.post("/userinfo/updatePurchase","old_pass="+md5(old_pass)+"&new_pass="+md5(new_pass)+"&csrf_token="+token,function(b){var b=$.parseJson(b);if(b!="error"){$("#oldPayPass").val("");$("#newPayPass").val("");$("#newPayPass1").val("");$("#changePayPwdModal").modal("hide");$.alert("修改成功!")}})}});$("#setPayPwdForm").validate({rules:{setPayPass:{required:true,rangelength:[6,16]},setPayPass1:{required:true,rangelength:[6,16],equalTo:"#setPayPass"}},messages:{setPayPass:{required:"6-16位字母、数字",rangelength:"6-16位字母、数字"},setPayPass1:{required:"6-16位字母、数字",rangelength:"6-16位字母、数字",equalTo:"两次输入的密码不一致"}},debug:true,success:function(a){$(a).html('<img src="../images/icons/icon_accept.png" />')},errorPlacement:function(a,b){$(a).css("line-height","5.4rem").css("margin-left","5px");$(a).appendTo($(b).parent().parent())},submitHandler:function(a){new_pass=$("#setPayPass").val();$.post("/userinfo/setPurchase","new_pass="+md5(new_pass)+"&csrf_token="+token,function(b){var b=$.parseJson(b);if(b!="error"){$("#setPayPass").val("");$("#setPayPass1").val("");$("#setPayPwdModal").modal("hide");$.alert("设置成功!");window.location.reload()}})}})});function changeArea(){var a=$("select[name='area']").val();$.post("/userinfo/updateArea","area="+a+"&csrf_token="+token,function(b){var b=$.parseJson(b);if(b!="error"){$("#area").html(b);$("#changeAreaModal").modal("hide");$.alert("修改成功!")}})}function changeAvatar(a){$.post("/userinfo/updateAvatar","avatar="+a+"&csrf_token="+token,function(b){var b=$.parseJson(b);if(b!="error"){$("#changeAvatarModal").modal("hide");$.alert("修改成功!");window.location.reload()}})}function showChangeArea(){$("#changeAreaModal").modal()}function showChangePwd(){$("#changePwdModal").modal();$("#oldPass").val("");$("#newPass").val("");$("#newPass1").val("")}function showChangePayPwd(){$("#changePayPwdModal").modal();$("#oldPayPass").val("");$("#newPayPass").val("");$("#newPayPass1").val("")}function showSetPayPwd(){$("#setPayPwdModal").modal();$("#setPayPass").val("");$("#setPayPass1").val("")}function showAvatarModal(){$("#avatarModal").modal()};